# Beckn Gateway Reference Implementation

## Version History

| Version | Release Date | Maintainer |
|---------|--------------|------------|
| 0.1     | Feb 07, 2022 | FIDE       |

## Introduction

BGs are extremely lean and stateless broadcast / multicast servers. The purpose of this infrastructure is to democratize discovery of BPPs by the BAPs. 

## Installation Guide

### Step 1: Install Dependencies
Clone and build the following repositories (using mvn install in each of the directories) in sequence. In case we are running the application on the same server we additionally need to install only applications no 4 and 5. 1,2,3 are common to both. But , if we are running on the different server we need to install all of the applications.

1. [Common](https://github.com/venkatramanm/common)
2. [Beckn SDK for Java](https://github.com/venkatramanm/beckn-sdk-java)
3. [Succinct Web Framework](https://github.com/venkatramanm/swf-all)
4. [Beckn plugin for Succinct](https://github.com/venkatramanm/swf-plugin-beckn)
5. [Beckn gateway plugin](https://github.com/venkatramanm/beckn-gateway)

### Step 2: Clone this repository
Run the following command
```
git clone git@github.com:beckn/reference-beckn-gateway.git
```

### Step 3: Configure Gateway
1. Go into the cloned folder.
```
   cd beckn-gateway-app
```
2. Copy sample `overrideProperties.sample` to `overrideProperties`;
```
   cp -R overrideProperties.sample overrideProperties
```
3. Locate swf.propeties file in overrideProperties and edit the section pertaining to "Beckn Gateway configurations"
```
in.succinct.beckn.gateway.subscriber_id=local_bg // replace with the domain ( Ex-registry.becknprotocol.io)
in.succinct.beckn.gateway.public_key_id=local_bg.k1 // replace with domain.k1 Ex- (registry.becknprotocol.io.k1)
in.succinct.beckn.registry.url=https://beckn-one.succinct.in/subscribers // Complete url of the server, where your application is hosted. Ex- https://registry.becknprotocol.io/subscribers
```

4. Configure Keys (Applicable For Beckn-one sandbox users)
- To obtain below keys, access the registry at : https://registry.becknprotocol.io and login with default credentials - root/root.
- Go to Network Participant, search for the term "Registry" and click view and go to participant key , copy the values and update the `swf.propeties` file. *
- Note: The keys are generated by the registry itself on the fly during setup

The keys after pasting should look like this
```
in.succinct.beckn.registry.signing_public_key=RDvQdPJe+YF/1aEZW4MSn+qlQgJg2kHo44TsG0UktTM= 
in.succinct.beckn.registry.encryption_public_key=CGU9GSWmSGd4ZVUZrM2b+QX9UcSbslgpqGaZ9IJkhi4=
```

## Running the application
From the base directory for beckn-gateway-app , run the following command
```
bin/swfstart
```

## Debugging
Check logs in the `tmp/` folder to see if there are any issues and resolve them
